"use strict";
function padString(n) {
    return n < 10 ? '0' + n.toFixed(0) : n.toFixed(0);
}
function formatDuration(sec) {
    var h = Math.floor(sec / 3600);
    sec -= 3600 * h;
    var m = Math.floor(sec / 60);
    sec -= 60 * m;
    var s = Math.floor(sec);
    return {
        hh: padString(h),
        mm: padString(m),
        ss: padString(s),
    };
}
function formatFee(cents) {
    return (cents / 100).toFixed(2);
}
Page({
    timer: undefined,
    tripID: '',
    data: {
        location: {
            latitude: 30,
            longitude: 120,
        },
        scale: 12,
        elapsed: '00:00:00',
        fee: '0.00',
        markers: [
            {
                iconPath: "/resources/car.png",
                id: 0,
                latitude: 30,
                longitude: 120,
                width: 20,
                height: 20,
            },
        ],
    },
    onLoad: function () {
        this.setupLocationUpdator();
        this.setupTimer();
    },
    setupLocationUpdator: function () {
        var _this = this;
        wx.startLocationUpdate({
            fail: console.error,
        });
        wx.onLocationChange(function (loc) {
            _this.setData({
                location: {
                    latitude: loc.latitude,
                    longitude: loc.longitude,
                },
            });
        });
    },
    setupTimer: function () {
        var _this = this;
        var elapsedSec = 0;
        this.timer = setInterval(function () {
            elapsedSec++;
            _this.setData({
                elapsed: "\u82B1\u4E86 " + elapsedSec + " \u5143",
                fee: formatFee(elapsedSec),
            });
        }, 1000);
    },
    onUnload: function () {
        wx.stopLocationUpdate();
        if (this.timer) {
            clearInterval(this.timer);
        }
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJpdmluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImRyaXZpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLFNBQVMsU0FBUyxDQUFDLENBQVM7SUFDeEIsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUNuRCxDQUFDO0FBRUQsU0FBUyxjQUFjLENBQUMsR0FBVztJQUMvQixJQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBQyxJQUFJLENBQUMsQ0FBQTtJQUM5QixHQUFHLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQTtJQUNmLElBQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxDQUFBO0lBQzlCLEdBQUcsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFBO0lBQ2IsSUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUN6QixPQUFPO1FBQ0gsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDaEIsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDaEIsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUM7S0FDbkIsQ0FBQTtBQUNMLENBQUM7QUFFRCxTQUFTLFNBQVMsQ0FBQyxLQUFhO0lBQzVCLE9BQU8sQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ25DLENBQUM7QUFFRCxJQUFJLENBQUM7SUFDRCxLQUFLLEVBQUUsU0FBNkI7SUFDcEMsTUFBTSxFQUFFLEVBQUU7SUFFVixJQUFJLEVBQUU7UUFDSixRQUFRLEVBQUU7WUFDUixRQUFRLEVBQUUsRUFBRTtZQUNaLFNBQVMsRUFBRSxHQUFHO1NBQ2Y7UUFDRCxLQUFLLEVBQUUsRUFBRTtRQUNULE9BQU8sRUFBRSxVQUFVO1FBQ25CLEdBQUcsRUFBRSxNQUFNO1FBQ1gsT0FBTyxFQUFFO1lBQ1A7Z0JBQ0UsUUFBUSxFQUFFLG9CQUFvQjtnQkFDOUIsRUFBRSxFQUFFLENBQUM7Z0JBQ0wsUUFBUSxFQUFFLEVBQUU7Z0JBQ1osU0FBUyxFQUFFLEdBQUc7Z0JBQ2QsS0FBSyxFQUFFLEVBQUU7Z0JBQ1QsTUFBTSxFQUFFLEVBQUU7YUFDWDtTQUNGO0tBQ0Y7SUFFRCxNQUFNO1FBQ0YsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUE7UUFDM0IsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFBO0lBQ3JCLENBQUM7SUFFRCxvQkFBb0I7UUFBcEIsaUJBYUM7UUFaQyxFQUFFLENBQUMsbUJBQW1CLENBQUM7WUFDbkIsSUFBSSxFQUFFLE9BQU8sQ0FBQyxLQUFLO1NBQ3RCLENBQUMsQ0FBQTtRQUVGLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFBLEdBQUc7WUFDbkIsS0FBSSxDQUFDLE9BQU8sQ0FBQztnQkFDVCxRQUFRLEVBQUU7b0JBQ04sUUFBUSxFQUFFLEdBQUcsQ0FBQyxRQUFRO29CQUN0QixTQUFTLEVBQUUsR0FBRyxDQUFDLFNBQVM7aUJBQzNCO2FBQ0osQ0FBQyxDQUFBO1FBQ04sQ0FBQyxDQUFDLENBQUE7SUFDSixDQUFDO0lBRUQsVUFBVTtRQUFWLGlCQVNDO1FBUkcsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFBO1FBQ2xCLElBQUksQ0FBQyxLQUFLLEdBQUcsV0FBVyxDQUFDO1lBQ3JCLFVBQVUsRUFBRSxDQUFBO1lBQ1osS0FBSSxDQUFDLE9BQU8sQ0FBQztnQkFDVCxPQUFPLEVBQUUsa0JBQU0sVUFBVSxZQUFJO2dCQUM3QixHQUFHLEVBQUUsU0FBUyxDQUFDLFVBQVUsQ0FBQzthQUM3QixDQUFDLENBQUE7UUFDTixDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDWixDQUFDO0lBRUQsUUFBUTtRQUNKLEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxDQUFBO1FBQ3ZCLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNaLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7U0FDNUI7SUFDTCxDQUFDO0NBQ0osQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcGFkU3RyaW5nKG46IG51bWJlcikge1xuICAgIHJldHVybiBuIDwgMTAgPyAnMCcrbi50b0ZpeGVkKDApIDogbi50b0ZpeGVkKDApXG59XG5cbmZ1bmN0aW9uIGZvcm1hdER1cmF0aW9uKHNlYzogbnVtYmVyKSB7XG4gICAgY29uc3QgaCA9IE1hdGguZmxvb3Ioc2VjLzM2MDApXG4gICAgc2VjIC09IDM2MDAgKiBoXG4gICAgY29uc3QgbSA9IE1hdGguZmxvb3Ioc2VjIC8gNjApXG4gICAgc2VjIC09IDYwICogbVxuICAgIGNvbnN0IHMgPSBNYXRoLmZsb29yKHNlYylcbiAgICByZXR1cm4ge1xuICAgICAgICBoaDogcGFkU3RyaW5nKGgpLFxuICAgICAgICBtbTogcGFkU3RyaW5nKG0pLFxuICAgICAgICBzczogcGFkU3RyaW5nKHMpLFxuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9ybWF0RmVlKGNlbnRzOiBudW1iZXIpIHtcbiAgICByZXR1cm4gKGNlbnRzIC8gMTAwKS50b0ZpeGVkKDIpXG59XG5cblBhZ2Uoe1xuICAgIHRpbWVyOiB1bmRlZmluZWQgYXMgbnVtYmVyfHVuZGVmaW5lZCxcbiAgICB0cmlwSUQ6ICcnLFxuXG4gICAgZGF0YToge1xuICAgICAgbG9jYXRpb246IHtcbiAgICAgICAgbGF0aXR1ZGU6IDMwLFxuICAgICAgICBsb25naXR1ZGU6IDEyMCxcbiAgICAgIH0sXG4gICAgICBzY2FsZTogMTIsXG4gICAgICBlbGFwc2VkOiAnMDA6MDA6MDAnLFxuICAgICAgZmVlOiAnMC4wMCcsXG4gICAgICBtYXJrZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpY29uUGF0aDogXCIvcmVzb3VyY2VzL2Nhci5wbmdcIixcbiAgICAgICAgICBpZDogMCxcbiAgICAgICAgICBsYXRpdHVkZTogMzAsXG4gICAgICAgICAgbG9uZ2l0dWRlOiAxMjAsXG4gICAgICAgICAgd2lkdGg6IDIwLFxuICAgICAgICAgIGhlaWdodDogMjAsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG5cbiAgICBvbkxvYWQgKCkge1xuICAgICAgICB0aGlzLnNldHVwTG9jYXRpb25VcGRhdG9yKClcbiAgICAgICAgdGhpcy5zZXR1cFRpbWVyKClcbiAgICB9LFxuICBcbiAgICBzZXR1cExvY2F0aW9uVXBkYXRvcigpIHtcbiAgICAgIHd4LnN0YXJ0TG9jYXRpb25VcGRhdGUoe1xuICAgICAgICAgIGZhaWw6IGNvbnNvbGUuZXJyb3IsXG4gICAgICB9KVxuICAgICAgXG4gICAgICB3eC5vbkxvY2F0aW9uQ2hhbmdlKGxvYyA9PiB7XG4gICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgICAgbG9jYXRpb246IHtcbiAgICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBsb2MubGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgICBsb25naXR1ZGU6IGxvYy5sb25naXR1ZGUsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSxcblxuICAgIHNldHVwVGltZXIoKSB7XG4gICAgICAgIGxldCBlbGFwc2VkU2VjID0gMFxuICAgICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgZWxhcHNlZFNlYysrXG4gICAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgICAgIGVsYXBzZWQ6IGDoirHkuoYgJHtlbGFwc2VkU2VjfSDlhYNgLFxuICAgICAgICAgICAgICAgIGZlZTogZm9ybWF0RmVlKGVsYXBzZWRTZWMpLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSwgMTAwMClcbiAgICB9LFxuXG4gICAgb25VbmxvYWQoKSB7XG4gICAgICAgIHd4LnN0b3BMb2NhdGlvblVwZGF0ZSgpXG4gICAgICAgIGlmICh0aGlzLnRpbWVyKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpXG4gICAgICAgIH1cbiAgICB9LFxufSkiXX0=